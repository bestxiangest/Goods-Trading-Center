# 校园二手物品交易平台 - API测试工具使用说明

## 🚀 快速开始

### 1. 启动服务器
确保Flask应用正在运行：
```bash
python app.py
```

### 2. 打开测试页面
在浏览器中访问：
- **API测试工具**: `http://localhost:5000/api_test.html`
- **后台管理**: `http://localhost:5000/admin`
- **API文档**: `http://localhost:5000/api/v1`

## 📋 测试流程建议

### 第一步：用户管理测试
1. **用户注册** - 创建测试用户
   - 用户名：testuser
   - 密码：123456
   - 邮箱：test@example.com
   - 地址：测试地址

2. **用户登录** - 获取访问令牌
   - 登录成功后会自动保存Token
   - Token会显示在页面顶部

3. **获取个人信息** - 验证登录状态

### 第二步：分类管理测试
1. **获取分类列表** - 查看现有分类
2. **创建分类** - 添加新的物品分类
   - 分类名称：电子产品
   - 描述：手机、电脑等电子设备

### 第三步：物品管理测试
1. **发布物品** - 创建测试物品
   - 标题：二手iPhone 13
   - 描述：9成新，无划痕
   - 分类ID：1（使用刚创建的分类）
   - 状态：like_new
   - 图片URL：https://example.com/image.jpg

2. **获取物品列表** - 查看所有物品
3. **获取物品详情** - 查看特定物品信息
4. **更新物品** - 修改物品信息

### 第四步：交易流程测试
1. **创建交易请求** - 对物品发起交易
2. **获取交易请求** - 查看交易列表
3. **处理交易请求** - 接受/拒绝/完成交易

### 第五步：评价系统测试
1. **创建评价** - 对完成的交易进行评价
2. **获取评价列表** - 查看用户评价

### 第六步：消息系统测试
1. **获取消息列表** - 查看系统消息
2. **发送消息** - 发送测试消息

### 第七步：统计数据测试
1. **获取统计数据** - 查看平台统计信息

## 🔧 测试技巧

### 认证相关
- 大部分API需要登录后才能使用
- 登录成功后Token会自动保存并用于后续请求
- 如果遇到401错误，请先登录

### 数据准备
- 建议先创建分类，再发布物品
- 物品ID、用户ID等需要从前面的API响应中获取
- 可以使用默认管理员账号：admin@qq.com / admin123

### 常见测试数据
```json
// 用户注册
{
  "username": "testuser",
  "password": "123456",
  "email": "test@example.com",
  "phone": "13800138000",
  "address": "北京市海淀区中关村大街1号"
}

// 创建分类
{
  "name": "电子产品",
  "description": "手机、电脑、平板等电子设备"
}

// 发布物品
{
  "title": "二手MacBook Pro",
  "description": "2021款，M1芯片，8GB内存，256GB存储，9成新",
  "category_id": 1,
  "condition": "like_new",
  "image_urls": ["https://example.com/macbook1.jpg", "https://example.com/macbook2.jpg"]
}
```

## 🐛 常见问题

### 1. 服务器连接失败
- 确保Flask应用正在运行
- 检查端口5000是否被占用
- 确认防火墙设置

### 2. 认证失败
- 检查是否已登录
- 确认Token是否有效
- 重新登录获取新Token

### 3. 参数错误
- 检查必填字段是否填写
- 确认数据格式是否正确
- 查看API文档了解参数要求

### 4. 数据库错误
- 确保数据库文件存在
- 检查数据库连接
- 重启应用重新初始化数据库

## 📚 API端点总览

### 用户管理 (/api/v1/users)
- POST `/register` - 用户注册
- POST `/login` - 用户登录
- GET `/me` - 获取个人信息
- PUT `/me` - 更新个人信息
- GET `/{user_id}` - 获取指定用户信息

### 物品管理 (/api/v1/items)
- POST `/` - 发布物品
- GET `/` - 获取物品列表
- GET `/{item_id}` - 获取物品详情
- PUT `/{item_id}` - 更新物品
- DELETE `/{item_id}` - 删除物品

### 分类管理 (/api/v1/categories)
- GET `/` - 获取分类列表
- POST `/` - 创建分类
- PUT `/{category_id}` - 更新分类
- DELETE `/{category_id}` - 删除分类

### 交易请求 (/api/v1/requests)
- POST `/` - 创建交易请求
- GET `/` - 获取交易请求列表
- GET `/{request_id}` - 获取交易请求详情
- PUT `/{request_id}` - 处理交易请求

### 评价管理 (/api/v1/reviews)
- POST `/` - 创建评价
- GET `/` - 获取评价列表
- GET `/{review_id}` - 获取评价详情

### 消息管理 (/api/v1/messages)
- GET `/` - 获取消息列表
- POST `/` - 发送消息
- PUT `/{message_id}/read` - 标记消息已读

### 统计数据 (/api/v1/statistics)
- GET `/` - 获取统计数据
- GET `/users` - 用户统计
- GET `/items` - 物品统计
- GET `/transactions` - 交易统计

## 💡 扩展建议

1. **批量测试** - 可以编写脚本批量创建测试数据
2. **性能测试** - 使用工具测试API性能
3. **错误处理** - 测试各种异常情况
4. **边界测试** - 测试参数边界值
5. **并发测试** - 测试多用户同时操作

---

**注意**: 这是一个测试工具，请不要在生产环境中使用。所有测试数据仅用于验证API功能。